- merged tth05's pull request for performance improvement